{% extends 'trustpoint/base.html' %}
{% load i18n %}
{% load crispy_forms_filters %}
{% block content %}

        <div class="card tp-card-centered">

                <div class="card-header">
                    <div class="">
                        <h2>{% trans "Certificate Details" %}</h2>
                    </div>
                </div>
                <div class="card-body">
                    <div class="tp-card-centered-content">

                        <h3>Certificate Subject and Names</h3>
                        <hr>

                        <div class="tp-card-split">
                            <div>Subject</div>
                            <div>
                                {% for entry in cert.subject.all %}
                                    {{ entry }}<br>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="tp-card-split">
                            <div>Common Name</div>
                            <div>{{ cert.common_name }}</div>
                        </div>

                        {% include 'pki/certificates/components/extensions/subject_alternative_name_extension_content.html' %}
                        <br><br><h3>General</h3>
                        <hr>
                        <div class="tp-card-split">
                            <div>Certificate Version</div>
                            <div>{{ cert.get_version_display }}</div>
                        </div>
                        <div class="tp-card-split">
                            <div>{% trans 'Serial Number' %}</div>
                            <div>{{ cert.serial_number }}</div>
                        </div>

                        <div class="tp-card-split">
                            <div>Fingerprint (SHA256)</div>
                            <div>{{ cert.sha256_fingerprint }}</div>
                        </div>

                        {% include 'pki/certificates/components/certificate_hierarchy.html' %}

                        <br><br><h3>{% trans 'Validity' %}</h3>
                        <hr>

                        <div class="tp-card-split">
                            <div>{% trans 'Not valid before' %}</div>
                            <div>{{ cert.not_valid_before }}</div>
                        </div>
                        <div class="tp-card-split">
                            <div>{% trans 'Not valid after' %}</div>
                            <div>{{ cert.not_valid_after }}</div>
                        </div>


                        <br><br><h3>Subject Public Key Info</h3>
                        <hr>

                        <div class="tp-card-split">
                            <div>Public Key Algorithm OID</div>
                            <div>{{ cert.spki_algorithm_oid }}</div>
                        </div>

                        <div class="tp-card-split">
                            <div>Public Key Algorithm</div>
                            <div>{{ cert.spki_algorithm }}</div>
                        </div>

                        {% if cert.issuer and cert.spki_ec_curve_oid != 'None' %}
                            <div class="tp-card-split">
                                <div>Public Key Curve OID</div>
                                <div>{{ cert.spki_ec_curve_oid }}</div>
                            </div>
                        {% endif %}

                        {% if cert.issuer and cert.spki_ec_curve %}
                            <div class="tp-card-split">
                                <div>Public Key Curve</div>
                                <div>{{ cert.spki_ec_curve }}</div>
                            </div>
                        {% endif %}

                        <div class="tp-card-split">
                            <div>Signature Algorithm Key Size</div>
                            <div>
                                {{ cert.spki_key_size }} Bits
                            </div>
                        </div>

                        <br><br><h3>{% trans 'Signature' %}</h3>
                        <hr>

                        <div class="tp-card-split">
                            <div>Signature Algorithm OID</div>
                            <div>{{ cert.signature_algorithm_oid }}</div>
                        </div>

                        <div class="tp-card-split">
                            <div>Signature Algorithm</div>
                            <div>{{ cert.signature_algorithm }}</div>
                        </div>

                        {% if cert.signature_algorithm_padding_scheme != 'None' %}
                            <div class="tp-card-split">
                                <div>Signature Algorithm Padding Scheme</div>
                                <div>{{ cert.signature_algorithm_padding_scheme }}</div>
                            </div>
                        {% endif %}

                        {% if cert.issuer and cert.issuer.spki_ec_curve_oid %}
                            <div class="tp-card-split">
                                <div>Signature Curve OID</div>
                                <div>{{ cert.issuer.spki_ec_curve_oid }}</div>
                            </div>
                        {% endif %}

                        {% if cert.issuer and cert.issuer.spki_ec_curve %}
                            <div class="tp-card-split">
                                <div>Signature Curve</div>
                                <div>{{ cert.issuer.spki_ec_curve }}</div>
                            </div>
                        {% endif %}

                        <div class="tp-card-split">
                            <div>Signature Algorithm Key Size</div>
                            <div>
                                {% if cert.issuer %}
                                    {{ cert.issuer.spki_key_size }} Bits
                                {% else %}
                                    {{ cert.spki_key_size }} Bits
                                {% endif %}
                            </div>
                        </div>


                        {% include 'pki/certificates/components/extensions/subject_alternative_name_extension.html' %}

                        {% include 'pki/certificates/components/extensions/issuer_alternative_name_extension.html' %}

                        {% include 'pki/certificates/components/extensions/basic_constraints_extension.html' %}

                        {% include 'pki/certificates/components/extensions/key_usage_extension.html' %}


                    </div>
                </div>
                <div class="card-footer">
                    <div class="tp-card-btn-footer">
                        <button type="button" value="Back" class="btn btn-secondary" onClick="history.back()">{% trans 'Back' %}</button>
                        <a href="{% url 'pki:certificates' %}" class="btn btn-secondary">{% trans 'Cancel' %}</a>
                        <a href="{% url 'pki:certificates-download' pks=cert.id %}" class="btn btn-primary">{% trans 'Download' %}</a>
                    </div>
                </div>
        </div>

{% endblock content %}