{% load i18n %}

{% block certificate_hierarchy %}
    <br><br><h2>Certificate Hierarchy</h2>
    <hr>

    <div class="tp-card-split">
        <div>Issuer</div>
        <div>
            {% for entry in cert.issuer.all %}
                {{ entry }}<br>
            {% endfor %}
        </div>
    </div>

    <div class="tp-card-split">
        <div>Cross signed certificate</div>
        <div>{{ cert.is_cross_signed }}</div>
    </div>

    {% for certificate_chain in cert.get_certificate_chains %}
        <br>
        <div class="tp-card-split">
            <div>Certificate Chain {{ forloop.counter }}</div>
            <div>
                {% for certificate in certificate_chain %}
                    <a href="{% url 'pki:certificate-detail' pk=certificate.id %}">
                        {% if certificate.common_name %}
                            commonName={{ certificate.common_name }}
                        {% else %}
                            serialNumber={{ certificate.serial_number }}
                        {% endif %}
                    </a><br>
                {% endfor %}
                <a href="#" class="btn btn-primary my-1">Download Certificate Chain (PEM)</a>
                <a href="#" class="btn btn-primary my-1">Download Certificate Chain (PKCS#7 - DER)</a>
                <a href="#" class="btn btn-primary my-1">Download Certificate Chain (PKCS#7 - PEM)</a>
            <br>
            </div>
        </div>
    {% endfor %}


{#    {% if cert.certificate_hierarchy_type != 'E' %}#}
{#        <div class="tp-card-split">#}
{#            <div>Issued Certificates</div>#}
{#            <div>#}
{#                {% for cert in cert.issued_certs.all %}#}
{#                    <a href="{% url 'pki:certificate-detail' pk=cert.id %}">#}
{#                        {% if cert.common_name %}#}
{#                            CN: {{ cert.common_name }}#}
{#                        {% else %}#}
{#                            Serial: {{ cert.serial_number }}#}
{#                        {% endif %}#}
{#                    </a>#}
{#                {% endfor %}#}
{#            </div>#}
{#        </div>#}
{#    {% endif %}#}

{% endblock certificate_hierarchy %}