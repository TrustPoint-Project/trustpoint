{% extends 'trustpoint/base.html' %}
{% load crispy_forms_filters %}
{% load static %}
{% block head %}
    <link rel="stylesheet" href="{% static 'css/onboarding.css' %}">
    <script>url = "{{ url }}"; icons = "{% static 'img/icons.svg' %}", parentUrl = "{% url 'onboarding:exit' device_id %}"</script>
    <script src="{% static 'js/onboarding.js' %}"></script>
{% endblock head %}
{% block content %}
    <div class="card card-main text-center">
        <div class="card-header d-flex">
            <h1>Onboarding device {{ device_name }} with Trustpoint Client</h1>
        </div>
        <div class="card-body tp-main-centered pt-3 pb-4">
            <h2>Trustpoint Client Download</h2>
            todo
            <hr>
            <h2>Trustpoint Client Provisioning command</h2>
            <pre class="mt-2"><code id="code-provisioning-0"> 
python -m trustpoint_client provision --tsotp {{ tsotp }} --tssalt {{ tssalt }} --otp {{ otp }} --salt {{ salt }} --url {{ url }} --tpurl {{ tpurl }} {% if sn %}--sn {{ sn }}{% endif %}</code>
            </pre>
            <div>
                <button class="btn btn-primary float-end" onclick="navigator.clipboard.writeText(document.querySelector('#code-provisioning-0').textContent)">Copy to clipboard</button>
            </div>
            <hr>
            <h2>Onboarding progress</h2>
            <div id="onboarding-state" class="alert alert-info d-flex align-items-center mt-3 breathing-anim" role="alert">  
                <svg class="bi flex-shrink-0 me-2" width="20" height="20" fill="currentColor" role="img" aria-label="State: "><use xlink:href="{% static 'img/icons.svg' %}#icon-clock"/></svg>
                <div><!-- class="text-white"> -->
                    Fetching state from server...
                </div>                
            </div>
        </div>
        <div class="card-footer text-body-secondary">
            <a href="{% url 'devices:devices' %}" class="btn btn-secondary">Back</a>
            <a href="{% url 'onboarding:exit' device_id %}" class="btn btn-danger">Cancel</a>
        </div>
    </div>
{% endblock content %}